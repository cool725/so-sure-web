{# Set Vars #}
{% set navbar_class = 'navbar-so-sure fixed-top' %}
{% if quote_mode is defined and quote_mode == true %}
    {% set navbar_class = 'navbar-so-sure-quote fixed-top' %}
{% endif %}
{% if onboarding_mode is defined and onboarding_mode == true %}
    {% set navbar_class = 'navbar-so-sure' %}
{% endif %}

<nav id="main-nav" class="navbar {{ navbar_class }} justify-content-between flex-nowrap flex-row pl-lg-5">

    {# Logo #}
    <a href="/" class="navbar-brand show-in-nav show-in-quote">
        <div class="navbar-brand__logo"></div>
        <span class="sr-only">so-sure</span>
    </a>

    {# Navs #}
    {% if admin_mode is defined and admin_mode == true %}
        {% include '::navigation/admin.html.twig' %}
    {% elseif quote_mode is defined and quote_mode == true %}
        {# üçÜ HIDE NAV üçÜ #}
    {% elseif onboarding_mode is defined and onboarding_mode == true %}
        {% include '::navigation/onboarding.html.twig' %}
    {% elseif seo_mode is defined and seo_mode == true %}
        {% include '::navigation/seo.html.twig' %}
    {% else %}
        <ul class="nav navbar-nav flex-row align-items-center">
            <li class="nav-item dropdown d-none d-xl-block pr-xl-5">
                <a href="#"
                   class="nav-link dropdown-toggle"
                   id="why_so_sure_nav"
                   role="button"
                   {# data-toggle="dropdown" #}
                   aria-haspopup="true"
                   aria-expanded="false">Why so-sure? <i class="far text-columbia-blue-f fa-chevron-down ml-2"></i></a>
                <div class="dropdown-menu dropdown-menu-nav" aria-labelledby="why_so_sure_nav">
                    <a class="dropdown-item dropdown-item-nav h6 mb-0"
                       href="{{ path('social_insurance') }}">
                        <img src="{{ cdn_url }}/images/rebrand/nav-icons/so-sure_nav_icon_social_insurance.png" alt="so-sure - Social insurance" width="50px" class="mr-4">
                        <span>
                            Social insurance ü§î<br>
                            <small class="sub text-zaffre">What is social insurance?</small>
                        </span>
                    </a>
                    <a class="dropdown-item dropdown-item-nav h6 mb-0"
                       href="{{ path('comparison') }}">
                        <img src="{{ cdn_url }}/images/rebrand/nav-icons/so-sure_nav_icon_compare_cover.png" alt="so-sure - Compare cover" width="50px" class="mr-4">
                        <span>
                            Compare cover üòé<br>
                            <small class="sub text-zaffre">Why we're better than the rest!</small>
                        </span>
                    </a>
                </div>
            </li>
            <li class="nav-item dropdown d-none d-xl-block pr-xl-5">
                <a href="#"
                   class="nav-link dropdown-toggle"
                   id="about_us_nav"
                   role="button"
                   {# data-toggle="dropdown" #}
                   aria-haspopup="true"
                   aria-expanded="false">About us <i class="far text-columbia-blue-f fa-chevron-down ml-2"></i></a>
                <div class="dropdown-menu dropdown-menu-nav" aria-labelledby="about_us_nav">
                    <a class="dropdown-item dropdown-item-nav h6 mb-0"
                       href="{{ path('faq') }}">
                        <img src="{{ cdn_url }}/images/rebrand/nav-icons/so-sure_nav_icon_faqs.png" alt="so-sure - FAQs" width="50px" class="mr-4">
                        <span>
                            FAQs ü§ì<br>
                            <small class="sub text-zaffre">We all need a little extra info</small>
                        </span>
                    </a>
                    <a class="dropdown-item dropdown-item-nav h6 mb-0"
                       href="{{ path('about_how_to_contact_so_sure') }}">
                        <img src="{{ cdn_url }}/images/rebrand/nav-icons/so-sure_nav_icon_contact_us.png" alt="so-sure - Contact us" width="50px" class="mr-4">
                        <span>
                            Contact us üí¨<br>
                            <small class="sub text-zaffre">We are always happy to talk</small>
                        </span>
                    </a>
                    {# <a class="dropdown-item dropdown-item-nav h6 mb-0"
                       href="{{ path('careers') }}">
                        <img src="{{ cdn_url }}/images/rebrand/nav-icons/so-sure_nav_icon_careers.png" alt="so-sure - Careers" width="50px" class="mr-4">
                        <span>
                            Careers üë©‚Äçüíª<br>
                            <small class="sub text-zaffre">Fancy working with us?</small>
                        </span>
                    </a> #}
                </div>
            </li>
            <li class="nav-item d-none d-xl-block pr-xl-5">
                <a href="https://blog.wearesosure.com"
                   target="_blank"
                   rel="noopener noreferrer"
                   class="nav-link">Blog</a>
            </li>
            {% if hide_login is not defined %}
                <li class="nav-item d-none d-xl-block pr-xl-5">
                    <a href="{{ path('claim') }}"
                       class="nav-link {{ app.request.get('_route') == 'claim' ? 'nav-active' }}">
                        Make a Claim
                    </a>
                </li>
            {% endif %}
            <li class="nav-item d-none-xxs {% if hide_login is not defined %}pr-xl-5{% endif %}">
                <a id="quote_btn" href="#" class="btn btn-sm py-1 btn-white get-a-quote disabled btn-shadow btn-swap">Get a Quote</a>
                {% if hide_login is not defined %}
                    {% if app.user is not null and app.user %}
                        {% if is_granted('ROLE_PREVIOUS_ADMIN') %}
                            <a href="{{ path('homepage', {'_impersonate': '_exit'}) }}"
                               class="btn btn-outline-white btn-sm show-in-nav btn-swap hideme"
                               title="{{ app.user.email }}"
                               ><i class="fas fa-user fa-fw"></i>
                                Exit User</a>
                        {% else %}
                            <a href="{{ path('fos_user_security_logout') }}"
                               class="btn btn-outline-white btn-sm show-in-nav btn-swap hideme">
                               <i class="fas fa-user fa-fw"></i> Log out</i></a>
                        {% endif %}
                    {% else %}
                        <a href="{{ path('fos_user_security_login') }}"
                           class="btn btn-outline-white btn-sm show-in-nav btn-swap hideme"><i class="fas fa-user fa-fw"></i> Customer login</a>
                    {% endif %}
                {% endif %}
            </li>
            {% if app.user is not null and app.user %}
                <li class="nav-item d-none d-xl-block pr-xl-5">
                    {% if is_granted('ROLE_ADMIN') %}
                        <a href="{{ path('admin_home') }}" class="nav-link user-link">Admin</a>
                    {% elseif is_granted('ROLE_EMPLOYEE') %}
                        <a href="{{ path('admin_home') }}" class="nav-link user-link">Admin</a>
                    {% elseif is_granted('ROLE_CLAIMS') %}
                        <a href="{{ path('claims_home') }}" class="nav-link user-link">Claims</a>
                    {% else %}
                        <a href="{{ path('user_home') }}" class="nav-link user-link">Your account</a>
                    {% endif %}
                </li>
            {% endif %}
            <li class="nav-item d-none d-xl-block pr-xl-5">
                {% if hide_login is not defined %}
                    {% if app.user is not null and app.user %}
                        {% if is_granted('ROLE_PREVIOUS_ADMIN') %}
                            <a href="{{ path('homepage', {'_impersonate': '_exit'}) }}" class="nav-link user-link">Exit <u>{{ app.user.email }}</u></a>
                        {% else %}
                            <a href="{{ path('fos_user_security_logout') }}" class="nav-link user-link">Log out</i></a>
                        {% endif %}
                    {% else %}
                        <a href="{{ path('fos_user_security_login') }}"
                           class="btn btn-outline-columbia-blue-f btn-sm">Customer login <i class="far fa-arrow-right fa-fw ml-2"></i></a>
                    {% endif %}
                {% endif %}
            </li>
            <li class="nav-item d-xl-none">
                <button id="nav_toggle" class="hamburger hamburger--spring-r hamburger--collapse show-in-nav" type="button">
                    <span class="hamburger-box">
                        <span class="hamburger-inner"></span>
                    </span>
                </button>
            </li>
        </ul>
    {% endif %}

    {# Get a quote #}
    {# TODO: If not needed this should not be show, hopefully including here makes sense #}
    {% if exclude_remote_scripts is not defined or not exclude_remote_scripts %}
        {% include 'AppBundle::Search/getQuote.html.twig' %}
    {% endif %}

    {# User Nav #}
    {% if user_mode is defined and user_mode == true %}
        {% include '::navigation/user.html.twig' %}
    {% endif %}

    {# Mobile Menu #}
    {% include '::navigation/menu.html.twig' %}
</nav>
