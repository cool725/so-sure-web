<source>
  type tail
  path /var/log/apache2/access.log
  pos_file /var/log/fluent/access.log.pos # This is where you record file position
  tag apache2.access #fluentd tag!
  format apache2 # Do you have a custom format? You can write your own regex.
</source>

<match **>
  type s3
  path apache/ # <s3 path> #(optional; default="")
  aws_key_id {{ logs_access_key }}
  aws_sec_key {{ logs_secret_key }}
  s3_bucket log.so-sure.com # <s3 bucket name> #(required)
  s3_region eu-west-1
  auto_create_bucket false # <true/false> #(optional; default=true)
  check_apikey_on_start true # <true/false> #(optional; default=true)
  buffer_path /var/log/fluent/s3
  format common_log
  fields "{:host => 'host', :user => 'user', :method => 'method', :path => 'path', :code => 'code', :size => 'size', :referer => 'referer', :agent => 'agent' }"
  flush_at_shutdown true
  time_slice_format  %Y%m%d%H
</match>
