{% extends 'base.html.twig' %}

{# Set vars #}
{% set new_stylesheet = 1 %}
{% set distraction_free = 1 %}

{% block stylesheets %}
    {{ parent() }}
    {% stylesheets output='css/*.css'
        'components/owl.carousel/owl.carousel.min.css'
        'components/owl.carousel/owl.theme.default.min.css'
        '@AppBundle/Resources/public/sass/page/checkoutNew.scss'
    %}
        <link rel="stylesheet" href="{{ asset_url }}">
    {% endstylesheets %}
{% endblock %}

{% block body %}

<section class="checkout">
    <div class="container">
        {% if policy.hasNextPolicy and policy.nextPolicy.status == "renewal" %}
            <h1 class="h2">
                <span class="title-top">
                    Your policy is scheduled to be renewed
                    {% if policy.hasCashback %}
                        <br>
                        Your cashback request was received and will be processed <span class="text-blue">28-45</span> days after your policy has ended.
                    {% endif %}
                </span>
            </h1>
        {% elseif policy.hasCashback %}
            <h1 class="h2"><span class="title-top">Your cashback request was received and will be processed <span class="text-blue">28-45</span> days after your policy has ended.</span></h1>
        {% else %}
            <h1>
                <span class="title-top">Renew your</span>
                <br class="visible-xs">
                <span class="title-phone text-blue text-nowrap">{{ policy.phone.make }} {{ policy.phone.model }} {% if policy.phone.memory %}{{ policy.phone.memory }}GB{% endif %} </span>
                <br class="visible-xs">
                <span class="title-top">insurance</span> <br>
                {% if policy.getPremiumPlan == 'monthly' %}
                    <span class="title-price">for just <span class="text-blue">£{{ renew.getAdjustedStandardMonthlyPremiumPrice }}</span> a month</span>
                {% else %}
                    <span class="title-price">for just <span class="text-blue">£{{ renew.getAdjustedYearlyPremiumPrice }}</span> a year</span>
                {% endif %}
            </h1>
        {% endif %}
    </div>
</section>

{# Page Modals #}
<div class="modal modal-fullscreen fade"
     id="policy-modal"
     tabindex="-1"
     role="dialog"
     aria-labelledby="So-Sure Policy Terms"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <i class="fa fa-times fa-lg" aria-hidden="true"></i>
                    <span class="sr-only">Close</span>
                </button>
                <h3>So-Sure Policy Terms</h3>
            </div>
            <div class="modal-body modal-policy">
                {{ render(controller('AppBundle:ApiView:policyLatestTerms', {'policy_key': policy_key, 'maxPotValue':  phone.getCurrentPhonePrice.maxPot })) }}
            </div>
        </div>
    </div>
</div>
{# End Page Modals #}

{% endblock %}

{% block modals %}{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {% javascripts
    'components/owl.carousel/owl.carousel.min.js'
    '@AppBundle/Resources/public/js/Default/index.js'
    '@AppBundle/Resources/public/js/User/renew.js'
     %}
    <script src="{{ asset_url }}"></script>{% endjavascripts %}
{% endblock %}
